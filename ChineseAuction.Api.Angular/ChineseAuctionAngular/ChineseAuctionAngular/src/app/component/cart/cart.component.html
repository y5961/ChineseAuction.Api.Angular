<div class="cart-container" dir="rtl">
  
  <div class="cart-header">
    <h2 class="step-title">×©×œ×‘ 1: ×‘×—×™×¨×ª ×—×‘×™×œ×•×ª ×›×¨×˜×™×¡×™×</h2>
  </div>

  <div class="cart-content">
    @if (cartPackages().length > 0 || cartGifts().length > 0) {
      
      @if (cartPackages().length > 0) {
        <h3 class="section-title">×—×‘×™×œ×•×ª</h3>
        <div class="items-list">
          @for (pkg of cartPackages(); track pkg.idPackage) {
            @if ((packageQuantities()[pkg.idPackage] || 0) > 0) {
              <div class="cart-item">
                <!-- <button class="delete-btn" (click)="removePackage(pkg.idPackage)">
                  <span class="icon-trash">ğŸ—‘ï¸</span>
                </button> -->
                
                <div class="price-info">
                  <div class="price">â‚ª{{ (pkg.price || 0) * (packageQuantities()[pkg.idPackage] || 0) }}</div>
                  <div class="unit-price">â‚ª{{ pkg.price }} ×œ×™×—×™×“×”</div>
                </div>

                <div class="item-details">
                  <div class="item-name">{{ pkg.name }}</div>
                  <div class="quantity-selector">
                    <button class="qty-btn" (click)="increment(pkg.idPackage)">+</button>
                    <span class="qty-val">{{ packageQuantities()[pkg.idPackage] }}</span>
                    <button class="qty-btn" (click)="decrement(pkg.idPackage)">-</button>
                  </div>
                </div>

                <div class="item-thumb package-thumb">
                    @if (pkg.image && pkg.image !== 'string') {
                      <img [src]="imageUrl + pkg.image">
                    } @else {
                      <img [src]="imageUrl + getPackageImage(pkg.idPackage)">
                    }
                </div>
              </div>
            }
          }
        </div>
      }

      @if (cartGifts().length > 0) {
        <h3 class="section-title">×¤×¨×¡×™× ×‘×”×’×¨×œ×•×ª</h3>
        <div class="items-list">
          @for (gift of cartGifts(); track gift.idGift) {
            <div class="cart-item gift-item">
              <!-- <button class="delete-btn">ğŸ—‘ï¸</button> -->
               <div class="item-name" style="color: rgb(93, 30, 153);">{{ gift.name }}</div>

              <div class="item-details gift-details">
                 <div class="quantity-selector">
                      <button class="qty-btn" (click)="incrementGift(gift.idGift)" [disabled]="!cartService.canAddGift(1)" [attr.title]="!cartService.canAddGift(1) ? cartService.ticketLimitMessage(1) : null">+</button>
                    <span class="qty-val">{{ giftQuantities()[gift.idGift] || gift.amount }}</span>
                    <button class="qty-btn" (click)="decrementGift(gift.idGift)">-</button>
                  </div>
              </div>

              <div class="item-thumb">
                @if (gift.image) {
                  <img [src]="giftImageUrl + gift.image">
                } @else {
                  <span class="placeholder">ğŸ</span>
                }
              </div>
            </div>
          }
        </div>
      }

    } @else {
      <div class="empty-state">
        <div class="empty-emoji">ğŸ›’</div>
        <p>×”×¡×œ ×©×œ×š ×¢×“×™×™×Ÿ ×¨×™×§</p>
      </div>
    }
  </div>
<div class="footer-sticky">
  <div class="progress-section">
    <div class="progress-text">
      <span class="count">{{ cartService.totalGiftCount() }} / {{ cartService.totalTickets() }}</span>
      <span class="label">× ×•×ª×¨×• ×œ×š ×œ××™××•×©</span>
    </div>
    <div class="progress-bar">
      <div class="fill" [style.width.%]="(cartService.totalGiftCount() / cartService.totalTickets()) * 100"></div>
    </div>
  </div>
  
  <div class="action-row">
    <button (click)="proceedToBuying()" class="btn-next">×œ×ª×©×œ×•×</button>
    <div class="cart-summary-icon">
      <span class="cart-count-badge">{{ cartService.totalGiftCount() }}</span>
      <span class="icon">ğŸ›’</span> 
    </div>
  </div>
</div>

</div>
